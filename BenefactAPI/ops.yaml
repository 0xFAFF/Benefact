name: api
vars:
  default:
    conn_string: ConnectionStrings:BenefactDatabase='Host={dbhost};Username={dbuser};Database=benefact;Password={dbpassword};'
    name: benefact_api
    commit: master
cmds:
  checkout:
    - cmd: git checkout {commit}
    - cmd: git pull
  build:
    - cmd: docker build -t {name} .
  clean:
    - steps: [stop]
    - cmd: docker image rm {name}
  mock:
    - cmd: docker run -it --rm --network={network} -e {conn_string} {name} --action mock
  migrate:
    - cmd: docker run -it --rm --network={network} -e {conn_string} {name} --action migrate
  run:
    - cmd: docker run -itd --network={network} -e {conn_string} --name {name} {name}
  stop:
    - cmd: docker stop {name}
    - cmd: docker container rm {name}
